<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Check Results - {{ task_id }}</title>
    
    {# 
        NOTE: This template assumes you have a mystyle.css or similar file 
        (like the one referenced in index.html) to style the output.
        If not, the output from core_check (which uses inline styles like
        <p style=background-color:Orange;>) will still render, but look basic.
    #}
    <link rel="stylesheet" type="text/css" href="/static/css/mystyle.css"> 
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result-container { margin-top: 20px; border: 1px solid #ccc; background-color: #f9f9f9; }
        .error-section { margin-top: 20px; padding: 15px; border: 2px solid #dc3545; background-color: #f8d7da; color: #721c24; }
        .error-list { list-style-type: disc; margin-left: 20px; }
        .summary-header { margin-bottom: 20px; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        .analysis-output table { border: solid; border-collapse: collapse; margin-bottom: 0; }
        /* Add styles here to better format the HTML output from your core_check logic */
        .analysis-output table th { padding-left: 2px; border: 1px solid #ddd; background-color: #f4f4f4; font-size: 12px; text-align: left;}
        .analysis-output table td { padding-left: 3px; border: 1px solid #ddd; vertical-align: top; font-size: 12px;}
        .analysis-output table tr:nth-child(even) { background-color: #f2f2f2; }
        .analysis-output p { margin: 5px 0; font-size: 11px; }
        
        
    </style>
</head>
<body>

    <header class="summary-header">
    <h1>eNG|Core Device Check Complete</h1>
    </header>
    <div style="width: 100%;display: inline-flex;">
        <div style="width: 50%;">
            <p><strong>Task timstamp:</strong> {{ timstamp }}</p>
        </div>
        <div >
            <p><strong>Status:</strong> Completed successfully.</p>
        </div>
    </div>

    {# ----------------------------------------------------------- #}
    {# 1. Display Errors/Failures First #}
    {# ----------------------------------------------------------- #}
    {% if errors %}
    <section class="error-section">
        <h2>Devices with Errors or Failures ({{ errors | length }} Total)</h2>
        <p>The following devices could not be fully processed. Check the server logs for detailed tracebacks.</p>
        <ul class="error-list">
            {% for error in errors %}
                <li>{{ error | safe }}</li>
            {% endfor %}
        </ul>
    </section>
    {% endif %}

    {# ----------------------------------------------------------- #}
    {# 2. Display Combined HTML Output #}
    {#    This is the core content generated by the old 'core_check' logic. #}
    {# ----------------------------------------------------------- #}
    <section class="result-container">
        <!-- <h2>Analysis Output</h2> -->
        <div class="analysis-output">
            {# The 'safe' filter is CRITICAL here. It tells Jinja2 to render the raw HTML 
               contained in combined_html, including your <table> and <p style=...> tags. #}
            {{ combined_html | safe }}
        </div>
    </section>

    <footer>
        <p><a href="/api/devices/check_form">Run Another Check</a></p>
    </footer>

</body>
</html>